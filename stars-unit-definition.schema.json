{
  "$id": "stars-unit-definition@0.16",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Stars Player Unit Definition",
  "description": "Specification for the unit definition of the stars player.",
  "type": "object",
  "properties": {
    "id": {
      "const": "stars-unit-definition",
      "description": "Ensures that this is the right definition type"
    },
    "version": {
      "type": "string",
      "default": "0.11",
      "description": "Version to better support legacy definitions."
    },
    "backgroundColor": {
      "type": "string",
      "description": "web-color",
      "examples": [
        "#ffaa56",
        "#ff1"
      ],
      "default": "#eeeeee"
    },
    "ribbonBars": {
      "type": "boolean",
      "description": "If true, two striped bars are shown to indicate a special presentation mode.",
      "default": false
    },
    "continueButtonShow": {
      "type": "string",
      "description": "Rule if the navigation button to continue is presented",
      "enum": [
        "NO",
        "ALWAYS",
        "ON_MAIN_AUDIO_COMPLETE",
        "ON_VIDEO_COMPLETE",
        "ON_ANY_RESPONSE",
        "ON_RESPONSES_COMPLETE"
      ],
      "default": "ALWAYS"
    },
    "mainAudio": {
      "type": "object",
      "description": "Parameters and source for main audio sequence used via upper left button.",
      "properties": {
        "audioSource": {
          "type": "string",
          "description": "base64 coded string "
        },
        "firstClickLayer": {
          "type": "boolean",
          "description": "If true, an overlapping click area covers all available space to catch first click to start audio.",
          "default": false
        },
        "animateButton": {
          "type": "boolean",
          "description": "If true, the audio trigger button is a bit moving to demand attention.",
          "default": false
        },
        "maxPlay": {
          "type": "integer",
          "description": "Maximum number of plays. If '0', then no limit exists.",
          "default": 0
        },
        "disableInteractionUntilComplete": {
          "type": "boolean",
          "description": "If true, any interaction is disabled until the main audio has been played at least once. The continue button is not affected by this.",
          "default": false
        }
      },
      "required": [
        "audioSource"
      ],
      "additionalProperties": false
    },
    "interactionType": {
      "type": "string",
      "description": "Type of interaction",
      "enum": [
        "BUTTONS",
        "DROP",
        "WRITE",
        "FIND_ON_IMAGE",
        "VIDEO",
        "IMAGE_ONLY"
      ]
    },
    "interactionParameters": {
      "description": "Every interaction type needs a different set of parameters.",
      "oneOf": [
        {
          "$ref": "#/definitions/parametersDrop"
        },
        {
          "$ref": "#/definitions/parametersWrite"
        },
        {
          "$ref": "#/definitions/parametersFindOnImage"
        },
        {
          "$ref": "#/definitions/parametersVideo"
        },
        {
          "$ref": "#/definitions/parametersButtons"
        }
      ]
    },
    "variableInfo": {
      "type": "array",
      "description": "Rules for coding and scoring the values",
      "items": {
        "$ref": "#/definitions/coding"
      },
      "minItems": 1
    },
    "audioFeedback": {
      "type": "object",
      "description": "",
      "properties": {
        "trigger": {
          "type": "string",
          "description": "Event triggering the evaluation of response(s) and playing feedback",
          "enum": [
            "CONTINUE_BUTTON_CLICK",
            "ANY_RESPONSE"
          ],
          "default": "CONTINUE_BUTTON_CLICK"
        },
        "feedback": {
          "type": "array",
          "description": "The feedback will be played for the variable just changed.",
          "items": {
            "$ref": "#/definitions/audioFeedback"
          },
          "minItems": 1
        }
      }
    }
  },
  "required": [
    "id",
    "interactionType"
  ],
  "additionalProperties": false,
  "definitions": {
    "option": {
      "description": "Text, image or icon are valid defintions of one button",
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "text": {
              "type": "string",
              "description": "Will be cropped if not enough space is given."
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "imageSource": {
              "type": "string",
              "description": "Image base64-coded"
            }
          }
        },
        {
          "type": "object",
          "properties": {
            "icon": {
              "type": "string",
              "description": "Icon provided by player",
              "enum": [
                "CHECK_GREEN",
                "CLOSE_RED",
                "CLAP_HANDS"
              ]
            }
          }
        }
      ]
    },
    "repeatButton": {
      "type": "object",
      "description": "Repeat one selection button several times",
      "properties": {
        "option": {
          "$ref": "#/definitions/option"
        },
        "numberOfOptions": {
          "type": "integer",
          "description": "Number of options. Every option carries a growing number of hand clapping images.",
          "default": 5
        }
      }
    },
    "parametersButtons": {
      "type": "object",
      "description": "These parameters will be used for interactionTypes BUTTONS and IMAGE_ONLY",
      "properties": {
        "variableId": {
          "type": "string",
          "description": "Name of the variable stored as id in the response data object.",
          "default": "BUTTONS"
        },
        "imageSource": {
          "type": "string",
          "description": "Stimulus image base64-coded."
        },
        "imagePosition": {
          "type": "string",
          "description": "Position of stimulus image",
          "enum": [
            "TOP",
            "LEFT"
          ],
          "default": "LEFT"
        },
        "text": {
          "type": "string",
          "description": "Stimulus text."
        },
        "buttonType": {
          "type": "string",
          "description": "Variant of button styling",
          "enum": [
            "BIG_SQUARE",
            "MEDIUM_SQUARE",
            "SMALL_SQUARE",
            "TEXT",
            "CIRCLE"
          ],
          "default": "MEDIUM_SQUARE"
        },
        "multiSelect": {
          "type": "boolean",
          "description": "If true, more than one option can be selected.",
          "default": false
        },
        "numberOfRows": {
          "type": "integer",
          "description": "The options are arranged in exact this number of rows regardless of the given space (no responsiveness). If an odd number of options is given, the upper row will contain of more options.",
          "default": 1
        },
        "options": {
          "oneOf": [
            {
              "type": "object",
              "description": "List of buttons.",
              "properties": {
                "buttons": {
                  "type": "array",
                  "items": {
                    "$ref": "#/definitions/option"
                  },
                  "minItems": 1
                }
              }
            },
            {
              "type": "object",
              "description": "Repeat one button.",
              "properties": {
                "repeatButton": {
                  "$ref": "#/definitions/repeatButton"
                }
              }
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "parametersDrop": {
      "type": "object",
      "description": "These parameters will be used for interactionType DROP",
      "properties": {
        "variableId": {
          "type": "string",
          "description": "Name of the variable stored as id in the response data object.",
          "default": "DROP"
        },
        "imageSource": {
          "type": "string",
          "description": "Image base64-coded, placed at the bottom."
        },
        "text": {
          "type": "string",
          "description": "If an image is given too, this text is used as alt."
        },
        "options": {
          "type": "array",
          "description": "Each option specifies one button.",
          "items": {
            "$ref": "#/definitions/option"
          },
          "minItems": 1
        }
      },
      "required": [
        "options"
      ],
      "additionalProperties": false
    },
    "parametersWrite": {
      "type": "object",
      "description": "These parameters will be used for interactionType WRITE",
      "properties": {
        "variableId": {
          "type": "string",
          "description": "Name of the variable stored as id in the response data object.",
          "default": "WRITE"
        },
        "imageSource": {
          "type": "string",
          "description": "Image base64-coded, placed at the top."
        },
        "text": {
          "type": "string",
          "description": "If image is given too, this text is used as alt."
        },
        "addBackspaceKey": {
          "type": "boolean",
          "description": "If true, a backspace key is added to the keybboard.",
          "default": true
        },
        "addUmlautKeys": {
          "type": "boolean",
          "description": "If true, keys for umlauts are added to the keyboard.",
          "default": true
        },
        "keysToAdd": {
          "type": "array",
          "description": "All chars/strings in the list are added in a new key row at the bottom. Example: Graphemes",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "examples": [
            "eu",
            "au",
            "ei",
            "ch",
            "sch",
            "ng"
          ],
          "default": []
        },
        "maxInputLength": {
          "type": "integer",
          "description": "Maximal number of characters for input.",
          "default": 10
        }
      },
      "additionalProperties": false
    },
    "parametersFindOnImage": {
      "type": "object",
      "description": "These parameters will be used for interactionType FIND_ON_IMAGE",
      "properties": {
        "variableId": {
          "type": "string",
          "description": "Name of the variable stored as id in the response data object.",
          "default": "FIND_ON_IMAGE"
        },
        "imageSource": {
          "type": "string",
          "description": "Image base64-coded, filling space as much as possible."
        },
        "text": {
          "type": "string",
          "description": "Placed below the image."
        },
        "size": {
          "type": "string",
          "description": "Size of circle to mark selected area. If options are given, this parameter works as default.",
          "enum": [
            "SMALL",
            "MEDIUM",
            "LARGE"
          ],
          "default": "MEDIUM"
        },
        "showArea": {
          "type": "string",
          "description": "This parameter visualises an area of the image. The position and size of the area is specified as 'x,y-x,y'. Use this parameter to prepare the coding and remove it before the test."
        }
      },
      "required": [
        "imageSource"
      ],
      "additionalProperties": false
    },
    "parametersVideo": {
      "type": "object",
      "description": "These parameters will be used for interactionType VIDEO",
      "properties": {
        "variableId": {
          "type": "string",
          "description": "Name of the variable stored as id in the response data object. The variable holds the play progress value as parts of 1.",
          "default": "VIDEO"
        },
        "videoSource": {
          "type": "string",
          "description": "Video base64-coded, filling space as much as possible."
        },
        "imageSource": {
          "type": "string",
          "description": "Image base64-coded, used as placeholder before and after playing."
        },
        "text": {
          "type": "string",
          "description": "Placed below the video."
        }
      },
      "required": [
        "videoSource"
      ],
      "additionalProperties": false
    },
    "code": {
      "type": "object",
      "description": "If more than one rule is given, the first will go.",
      "properties": {
        "method": {
          "type": "string",
          "description": "Method to compare value with parameter",
          "enum": [
            "EQUALS",
            "GREATER_THAN",
            "LESS_THAN",
            "IN_POSITION_RANGE"
          ]
        },
        "parameter": {
          "type": "string",
          "description": "Value to compare with"
        },
        "code": {
          "type": "integer"
        },
        "score": {
          "type": "integer"
        }
      },
      "required": [
        "method",
        "parameter",
        "code",
        "score"
      ],
      "additionalProperties": false
    },
    "coding": {
      "type": "object",
      "properties": {
        "variableId": {
          "type": "string",
          "description": "Name of the variable to be coded."
        },
        "responseComplete": {
          "type": "string",
          "description": "Parameter to comply with Verona state changed notification",
          "enum": [
            "ALWAYS",
            "ON_ANY_RESPONSE",
            "ON_FULL_CREDIT"
          ],
          "default": "ALWAYS"
        },
        "codingSource": {
          "type": "string",
          "description": "Where the value for evaluation comes from.",
          "enum": [
            "VALUE",
            "VALUE_TO_UPPER",
            "SUM"
          ],
          "default": "VALUE"
        },
        "codes": {
          "type": "array",
          "description": "First true code will be taken. If not code matches, code and score will be '0'. If the given code list includes code '0', the next available code will be taken.",
          "items": {
            "$ref": "#/definitions/code"
          },
          "minItems": 1
        }
      },
      "required": [
        "variableId",
        "codes"
      ],
      "additionalProperties": false
    },
    "audioFeedback": {
      "type": "object",
      "properties": {
        "variableId": {
          "type": "string",
          "description": "Name of the variable to trigger the feedback."
        },
        "source": {
          "type": "string",
          "description": "Where the value for evaluation comes from.",
          "enum": [
            "VALUE",
            "CODE",
            "SCORE"
          ],
          "default": "CODE"
        },
        "method": {
          "type": "string",
          "description": "Method to compare value with parameter",
          "enum": [
            "EQUALS",
            "GREATER_THAN",
            "LESS_THAN"
          ],
          "default": "EQUALS"
        },
        "parameter": {
          "type": "string",
          "description": "Value to compare with"
        },
        "audioSource": {
          "type": "string",
          "description": "base64 coded string for audio sequence used via upper left button"
        }
      },
      "required": [
        "variableId",
        "parameter",
        "audioSource"
      ],
      "additionalProperties": false
    }
  }
}